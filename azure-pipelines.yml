trigger:
- master

schedules:
- cron: "0 0 * * 0"
  displayName: Weekly midnight (UTC) build
  branches:
    include:
    - master
  always: true

pool:
  vmImage: 'macOS-10.14'

steps:
- script: |
    ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
  displayName: 'Install Homebrew and brew bundle'
  
- script: |
    rm '/usr/local/bin/aws'
    rm '/usr/local/bin/aws_completer'
    rm '/usr/local/bin/2to3'
  displayName: 'Remove existing awscli components to avoid errors'

- script: |
    rm '/usr/local/bin/go'
    rm '/usr/local/bin/gofmt'
  displayName: 'Remove existing golang components to avoid errors'

- script: |
    brew bundle
  displayName: 'Install dependencies from Brewfile'
